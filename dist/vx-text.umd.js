!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("prop-types"),require("react"),require("reduce-css-calc")):"function"==typeof define&&define.amd?define(["exports","prop-types","react","reduce-css-calc"],e):e(t.vx=t.vx||{},t.PropTypes,t.React,t.reduceCSSCalc)}(this,function(t,e,r,T){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var P="default"in r?r.default:r;function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(){return(S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function W(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}T=T&&T.hasOwnProperty("default")?T.default:T;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s="object"==typeof n&&n&&n.Object===Object&&n,u="object"==typeof self&&self&&self.Object===Object&&self,l=s||u||Function("return this")(),p=l.Symbol,f=Object.prototype,h=f.hasOwnProperty,d=f.toString,y=p?p.toStringTag:void 0;var v=function(t){var e=h.call(t,y),n=t[y];try{t[y]=void 0}catch(t){}var r=d.call(t);return e?t[y]=n:delete t[y],r},g=Object.prototype.toString;var _=function(t){return g.call(t)},b=p?p.toStringTag:void 0;var w=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?v(t):_(t)};var O=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var m,j=function(t){if(!O(t))return!1;var e=w(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},x=l["__core-js_shared__"],k=(m=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"";var A=function(t){return!!k&&k in t},C=Function.prototype.toString;var E=function(t){if(null!=t){try{return C.call(t)}catch(t){}try{return t+""}catch(t){}}return""},z=/^\[object .+?Constructor\]$/,F=Function.prototype,B=Object.prototype,L=F.toString,H=B.hasOwnProperty,R=RegExp("^"+L.call(H).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var $=function(t){return!(!O(t)||A(t))&&(j(t)?R:z).test(E(t))};var N=function(t,e){return null==t?void 0:t[e]};var q=function(t,e){var n=N(t,e);return $(n)?n:void 0},I=q(Object,"create");function M(){this.__data__=I?I(null):{},this.size=0}function G(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var J=Object.prototype.hasOwnProperty;function U(t){var e=this.__data__;if(I){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return J.call(e,t)?e[t]:void 0}var D=Object.prototype.hasOwnProperty;function K(t){var e=this.__data__;return I?void 0!==e[t]:D.call(e,t)}function Q(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=I&&void 0===e?"__lodash_hash_undefined__":e,this}function V(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}V.prototype.clear=M,V.prototype.delete=G,V.prototype.get=U,V.prototype.has=K,V.prototype.set=Q;var X=V;function Y(){this.__data__=[],this.size=0}var Z=function(t,e){return t===e||t!=t&&e!=e};var tt=function(t,e){for(var n=t.length;n--;)if(Z(t[n][0],e))return n;return-1},et=Array.prototype.splice;function nt(t){var e=this.__data__,n=tt(e,t);return!(n<0)&&(n==e.length-1?e.pop():et.call(e,n,1),--this.size,!0)}function rt(t){var e=this.__data__,n=tt(e,t);return n<0?void 0:e[n][1]}function ot(t){return-1<tt(this.__data__,t)}function it(t,e){var n=this.__data__,r=tt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function at(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}at.prototype.clear=Y,at.prototype.delete=nt,at.prototype.get=rt,at.prototype.has=ot,at.prototype.set=it;var ct=at,st=q(l,"Map");var ut=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var lt=function(t,e){var n=t.__data__;return ut(e)?n["string"==typeof e?"string":"hash"]:n.map};function pt(t){var e=lt(this,t).delete(t);return this.size-=e?1:0,e}function ft(t){return lt(this,t).get(t)}function ht(t){return lt(this,t).has(t)}function dt(t,e){var n=lt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function yt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}yt.prototype.clear=function(){this.size=0,this.__data__={hash:new X,map:new(st||ct),string:new X}},yt.prototype.delete=pt,yt.prototype.get=ft,yt.prototype.has=ht,yt.prototype.set=dt;var vt=yt,gt="Expected a function";function _t(o,i){if("function"!=typeof o||null!=i&&"function"!=typeof i)throw new TypeError(gt);var a=function(){var t=arguments,e=i?i.apply(this,t):t[0],n=a.cache;if(n.has(e))return n.get(e);var r=o.apply(this,t);return a.cache=n.set(e,r)||n,r};return a.cache=new(_t.Cache||vt),a}_t.Cache=vt;var bt="__react_svg_text_measurement_id";var wt=_t(function(t,e){try{var n=document.getElementById(bt);if(!n){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.width=0,r.style.height=0,r.style.position="absolute",r.style.top="-100%",r.style.left="-100%",(n=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("id",bt),r.appendChild(n),document.body.appendChild(r)}return Object.assign(n.style,e),n.textContent=t,n.getComputedTextLength()}catch(t){return null}},function(t,e){return"".concat(t,"_").concat(JSON.stringify(e))}),Ot=function(){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=c(this,i(n).call(this,t))).state={wordsByLines:[]},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(n,r.Component),function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(n,[{key:"componentWillMount",value:function(){this.updateWordsByLines(this.props,!0)}},{key:"componentWillReceiveProps",value:function(t){var e=this.props.children!==t.children||this.props.style!==t.style;this.updateWordsByLines(t,e)}},{key:"updateWordsByLines",value:function(e,t){if(e.width||e.scaleToFit){if(t){var n=e.children?e.children.toString().split(/\s+/):[];this.wordsWithComputedWidth=n.map(function(t){return{word:t,width:wt(t,e.style)}}),this.spaceWidth=wt("Â ",e.style)}var r=this.calculateWordsByLines(this.wordsWithComputedWidth,this.spaceWidth,e.width*e.scale);this.setState({wordsByLines:r})}else this.updateWordsWithoutCalculate(e)}},{key:"updateWordsWithoutCalculate",value:function(t){var e=t.children?t.children.toString().split(/\s+/):[];this.setState({wordsByLines:[{words:e}]})}},{key:"calculateWordsByLines",value:function(t,a,c){var s=this.props.scaleToFit;return t.reduce(function(t,e){var n=e.word,r=e.width,o=t[t.length-1];if(o&&(null==c||s||o.width+r+a<c))o.words.push(n),o.width+=r+a;else{var i={words:[n],width:r};t.push(i)}return t},[])}},{key:"leftShift",value:function(){var t=this.props,e=t.align,n=t.width,r=t.x;switch(e){case"left":return r;case"center":return n/2;case"right":return n;default:return console.error("unsupported align value ".concat(e)),r}}},{key:"textAnchor",value:function(){var t=this.props.align;switch(t){case"left":return"start";case"center":return"middle";case"right":return"end";default:return console.error("unsupported align value ".concat(t)),"start"}}},{key:"render",value:function(){var n,r=this,t=this.props,e=t.dx,o=t.dy,i=t.textAnchor,a=t.verticalAnchor,c=t.scale,s=(t.align,t.defs),u=t.scaleToFit,l=t.angle,p=t.lineHeight,f=t.capHeight,h=t.lineProps,d=t.innerRef,y=W(t,["dx","dy","textAnchor","verticalAnchor","scale","align","defs","scaleToFit","angle","lineHeight","capHeight","lineProps","innerRef"]),v=this.state.wordsByLines,g=y.x,_=y.y;switch(a){case"start":n=T("calc(".concat(f,")"));break;case"middle":n=T("calc(".concat((v.length-1)/2," * -").concat(p," + (").concat(f," / 2))"));break;default:n=T("calc(".concat(v.length-1," * -").concat(p,")"))}var b=[];if(u&&v.length){var w=v[0].width,O=this.props.width*c/w,m=O,j=g-O*g,x=_-m*_;b.push("matrix(".concat(O,", 0, 0, ").concat(m,", ").concat(j,", ").concat(x,")"))}return l&&b.push("rotate(".concat(l,", ").concat(g,", ").concat(_,")")),b.length&&(y.transform=b.join(" ")),P.createElement("svg",{ref:d,x:e,y:o,fontSize:y.fontSize,style:{overflow:"visible"}},P.createElement("defs",null,s),P.createElement("text",S({},y,{textAnchor:i}),v.map(function(t,e){return P.createElement("tspan",S({x:r.leftShift(),textAnchor:r.textAnchor(),dy:0===e?n:p},h,{key:e}),t.words.join(" "))})))}}]),n}();Ot.defaultProps={x:0,y:0,dx:0,dy:0,lineHeight:"1em",capHeight:"0.71em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",scale:1,align:"left",defs:null,lineProps:{}},Ot.propTypes={scaleToFit:e.bool,angle:e.number,textAnchor:e.oneOf(["start","middle","end","inherit"]),verticalAnchor:e.oneOf(["start","middle","end"]),style:e.objectOf(e.string),scale:e.number,align:e.oneOf(["left","center","right"]),defs:e.oneOfType([e.arrayOf(e.node),e.node]),innerRef:e.oneOfType([e.func,e.object]),x:e.oneOfType([e.number,e.string]),y:e.oneOfType([e.number,e.string]),dx:e.oneOfType([e.number,e.string]),dy:e.oneOfType([e.number,e.string]),lineHeight:e.oneOfType([e.number,e.string]),capHeight:e.oneOfType([e.number,e.string]),lineProps:e.objectOf(e.string)},t.Text=Ot,t.getStringWidth=wt,Object.defineProperty(t,"__esModule",{value:!0})});
